---
id: ci-cd-integration
title: CI/CD Integration
---

import { Image } from '@components';
import { Table } from '@components';

## Prerequisites
Perform a [one time setup](./one-time-setup) before you continue with CI/CD integration.

## CI/CD Integration

The Drill4Net agent should run after the build step in CI/CD pipeline:
<Image src="/img/drill4net/drill4net-build-pipeline.svg"/>

### 1. Change Build Version in Configurations
Each build should change build version in *Test Agent* and *Drill4Net Scanner* appsettings.yml.
1. Change `adminAgentConfig:buildVersion` in *Drill4Net Scanner* appsettings.yml to version of current build.
2. Change `AdminAgentConfig:BuildVersion` in *Drill4Net Injector* drill4netsettings.yml to version of current build.

### 2. Run Drill4Net Scanner
[Run Drill4Net Scanner](./one-time-setup#7-run-drill4net-scanner) for current build.

### 3. Run Drill4Net Injector
Run Drill4Net.Injector.App for current build. Example for Windows:
```
start Drill4Net.Injector.App.exe
```
You can also provide `TestAssemblySourcePath` argument. In this case, value from drill4netsettings.yml will be overriden. Example for Windows:
```
start Drill4Net.Injector.App.exe "d:\Builds\AppUnderTest.Tests\netcoreapp3.1\AppUnderTest.Tests.dll"
```

### 4. Run Integration Tests
Run your integration tests from assembly provided to *Test Agent*. Note that tests should run only after Drill4Net.Injector.App run is
successfully finsihed. Make sure you run tests without rebuilding before running tests.

### 5. Get Suggested Tests to Run
You can execute the `curl` command to get suggested tests to run:
```
curl -i -H "accept: application/json" \
  -H "content-type: application/json" \
  -X GET {drill4j-address}/api/agents/{agent-id}/plugins/test2code/data/tests-to-run
```
`drill4j-address` is the address of *Drill4J Admin*, for example `http://localhost:8091`.

`agent-id` is the value of `adminAgentConfig:id` provided in *Drill4Net Scanner* earlier.
