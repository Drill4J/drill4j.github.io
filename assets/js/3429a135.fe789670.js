(self.webpackChunkdrill4j_github_io=self.webpackChunkdrill4j_github_io||[]).push([[60],{8014:function(e,n,a){"use strict";a.r(n),a.d(n,{frontMatter:function(){return s},metadata:function(){return c},toc:function(){return r},default:function(){return p}});var t=a(2122),i=a(9756),o=(a(7294),a(3905)),l=a(1720),s={id:"java-switch-scope-event-flow",title:"Switch Scope Event Flow"},c={unversionedId:"for-development/java-agent/java-switch-scope-event-flow",id:"for-development/java-agent/java-switch-scope-event-flow",isDocsHomePage:!1,title:"Switch Scope Event Flow",description:"Details",source:"@site/docs/for-development/java-agent/java-switch-scope-event-flow.mdx",sourceDirName:"for-development/java-agent",slug:"/for-development/java-agent/java-switch-scope-event-flow",permalink:"/docs/for-development/java-agent/java-switch-scope-event-flow",version:"current",frontMatter:{id:"java-switch-scope-event-flow",title:"Switch Scope Event Flow"},sidebar:"docs",previous:{title:"Coverage Collection Event Flow",permalink:"/docs/for-development/java-agent/java-coverage-receiving-event-flow"},next:{title:"JS Agent / Admin Backend Communication",permalink:"/docs/for-development/java-script-agent/js-agent-admin-be-communication"}},r=[{value:"Details",id:"details",children:[{value:"Precondition",id:"precondition",children:[]},{value:"Flow",id:"flow",children:[]},{value:"Sequence Diagram",id:"sequence-diagram",children:[]}]},{value:"API",id:"api",children:[{value:"Agent Incoming Messages:",id:"agent-incoming-messages",children:[]},{value:"Agent Outgoing Messages:",id:"agent-outgoing-messages",children:[]},{value:"Admin Incoming Messages:",id:"admin-incoming-messages",children:[]}]}],d={toc:r};function p(e){var n=e.components,a=(0,i.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,t.Z)({},d,a,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"details"},"Details"),(0,o.kt)("h3",{id:"precondition"},"Precondition"),(0,o.kt)("p",null,"An Agent has established a connection with the Drill Admin."),(0,o.kt)("h3",{id:"flow"},"Flow"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"User executes HTTP request to finish/delete scope."),(0,o.kt)("li",{parentName:"ol"},"Admin does an action ",(0,o.kt)("strong",{parentName:"li"},"SwitchActiveScope"),"."),(0,o.kt)("li",{parentName:"ol"},"Admin's plugin part finish/delete scope and sends ",(0,o.kt)("strong",{parentName:"li"},"InitActiveScope")," to the Agent's plugin part."),(0,o.kt)("li",{parentName:"ol"},"Agent's plugin part responds ",(0,o.kt)("strong",{parentName:"li"},"ScopeInitialized")," to Admin's plugin part."),(0,o.kt)("li",{parentName:"ol"},"Admin initializes new scope and recalculates build coverage.")),(0,o.kt)("h3",{id:"sequence-diagram"},"Sequence Diagram"),(0,o.kt)(l.Ee,{src:"/img/for-development/switch-scope-sequence.png",mdxType:"Image"}),(0,o.kt)("h2",{id:"api"},"API"),(0,o.kt)("h3",{id:"agent-incoming-messages"},"Agent Incoming Messages:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'@Serializable\n@SerialName("INIT_ACTIVE_SCOPE")\ndata class InitActiveScope(val payload: InitScopePayload) : AgentAction()\n\n@Serializable\ndata class InitScopePayload(\n    val id: String,\n    val name: String,\n    val prevId: String\n)\n\n')),(0,o.kt)("h3",{id:"agent-outgoing-messages"},"Agent Outgoing Messages:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'@SerialName("SCOPE_INITIALIZED")\n@Serializable\ndata class ScopeInitialized(\n    val id: String,\n    val name: String,\n    val prevId: String,\n    val ts: Long\n) : CoverMessage()\n')),(0,o.kt)("h3",{id:"admin-incoming-messages"},"Admin Incoming Messages:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'\n\n@SerialName("SWITCH_ACTIVE_SCOPE")\n@Serializable\ndata class SwitchActiveScope(val payload: ActiveScopeChangePayload) : Action()\n\n@Serializable\ndata class ActiveScopeChangePayload(\n    val scopeName: String,\n    val savePrevScope: Boolean = false,\n    val prevScopeEnabled: Boolean = true,\n) : JvmSerializable\n')))}p.isMDXComponent=!0}}]);