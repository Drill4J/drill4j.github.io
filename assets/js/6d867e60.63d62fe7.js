(self.webpackChunkdrill4j_github_io=self.webpackChunkdrill4j_github_io||[]).push([[3960],{1899:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return a},metadata:function(){return s},toc:function(){return u},default:function(){return p}});var i=n(2122),r=n(9756),l=(n(7294),n(3905)),o=n(549),a={id:"ci-cd-integration",title:"CI/CD Integration"},s={unversionedId:"drill4net/ci-cd-integration",id:"drill4net/ci-cd-integration",isDocsHomePage:!1,title:"CI/CD Integration",description:"Prerequisites",source:"@site/docs/drill4net/ci-cd-integration.mdx",sourceDirName:"drill4net",slug:"/drill4net/ci-cd-integration",permalink:"/docs/drill4net/ci-cd-integration",version:"current",frontMatter:{id:"ci-cd-integration",title:"CI/CD Integration"},sidebar:"docs",previous:{title:"Tests Project Setup",permalink:"/docs/drill4net/tests-project-setup"},next:{title:"Configuration",permalink:"/docs/drill4net/configuration"}},u=[{value:"Prerequisites",id:"prerequisites",children:[]},{value:"CI/CD Integration",id:"cicd-integration",children:[{value:"1. Change Build Version in Configurations",id:"1-change-build-version-in-configurations",children:[]},{value:"2. Run Drill4Net Scanner",id:"2-run-drill4net-scanner",children:[]},{value:"3. Run Drill4Net Injector",id:"3-run-drill4net-injector",children:[]},{value:"4. Run Integration Tests",id:"4-run-integration-tests",children:[]},{value:"5. Get Suggested Tests to Run",id:"5-get-suggested-tests-to-run",children:[]}]}],d={toc:u};function p(e){var t=e.components,n=(0,r.Z)(e,["components"]);return(0,l.kt)("wrapper",(0,i.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,l.kt)("p",null,"Perform a ",(0,l.kt)("a",{parentName:"p",href:"./one-time-setup"},"one time setup")," before you continue with CI/CD integration."),(0,l.kt)("h2",{id:"cicd-integration"},"CI/CD Integration"),(0,l.kt)("p",null,"The Drill4Net agent should run after the build step in CI/CD pipeline:"),(0,l.kt)(o.Ee,{src:"/img/drill4net/drill4net-build-pipeline.svg",mdxType:"Image"}),(0,l.kt)("h3",{id:"1-change-build-version-in-configurations"},"1. Change Build Version in Configurations"),(0,l.kt)("p",null,"Each build should change build version in ",(0,l.kt)("em",{parentName:"p"},"Test Agent")," and ",(0,l.kt)("em",{parentName:"p"},"Drill4Net Scanner")," appsettings.yml."),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Change ",(0,l.kt)("inlineCode",{parentName:"li"},"adminAgentConfig:buildVersion")," in ",(0,l.kt)("em",{parentName:"li"},"Drill4Net Scanner")," appsettings.yml to version of current build."),(0,l.kt)("li",{parentName:"ol"},"Change ",(0,l.kt)("inlineCode",{parentName:"li"},"AdminAgentConfig:BuildVersion")," in ",(0,l.kt)("em",{parentName:"li"},"Drill4Net Injector")," drill4netsettings.yml to version of current build.")),(0,l.kt)("h3",{id:"2-run-drill4net-scanner"},"2. Run Drill4Net Scanner"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"./one-time-setup#7-run-drill4net-scanner"},"Run Drill4Net Scanner")," for current build."),(0,l.kt)("h3",{id:"3-run-drill4net-injector"},"3. Run Drill4Net Injector"),(0,l.kt)("p",null,"Run Drill4Net.Injector.App for current build. Example for Windows:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"start Drill4Net.Injector.App.exe\n")),(0,l.kt)("p",null,"You can also provide ",(0,l.kt)("inlineCode",{parentName:"p"},"TestAssemblySourcePath")," argument. In this case, value from drill4netsettings.yml will be overriden. Example for Windows:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'start Drill4Net.Injector.App.exe "d:\\Builds\\AppUnderTest.Tests\\netcoreapp3.1\\AppUnderTest.Tests.dll"\n')),(0,l.kt)("h3",{id:"4-run-integration-tests"},"4. Run Integration Tests"),(0,l.kt)("p",null,"Run your integration tests from assembly provided to ",(0,l.kt)("em",{parentName:"p"},"Test Agent"),". Note that tests should run only after Drill4Net.Injector.App run is\nsuccessfully finsihed. Make sure you run tests without rebuilding before running tests."),(0,l.kt)("h3",{id:"5-get-suggested-tests-to-run"},"5. Get Suggested Tests to Run"),(0,l.kt)("p",null,"You can execute the ",(0,l.kt)("inlineCode",{parentName:"p"},"curl")," command to get suggested tests to run:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'curl -i -H "accept: application/json" \\\n  -H "content-type: application/json" \\\n  -X GET {drill4j-address}/api/agents/{agent-id}/plugins/test2code/data/tests-to-run\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"drill4j-address")," is the address of ",(0,l.kt)("em",{parentName:"p"},"Drill4J Admin"),", for example ",(0,l.kt)("inlineCode",{parentName:"p"},"http://localhost:8091"),"."),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"agent-id")," is the value of ",(0,l.kt)("inlineCode",{parentName:"p"},"adminAgentConfig:id")," provided in ",(0,l.kt)("em",{parentName:"p"},"Drill4Net Scanner")," earlier."))}p.isMDXComponent=!0}}]);