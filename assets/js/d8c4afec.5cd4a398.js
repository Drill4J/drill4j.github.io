(self.webpackChunkdrill4j_github_io=self.webpackChunkdrill4j_github_io||[]).push([[9508],{3905:function(e,t,a){"use strict";a.d(t,{Zo:function(){return c},kt:function(){return u}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),d=s(a),u=r,k=d["".concat(p,".").concat(u)]||d[u]||m[u]||l;return a?n.createElement(k,i(i({ref:t},c),{},{components:a})):n.createElement(k,i({ref:t},c))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=d;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var s=2;s<l;s++)i[s]=a[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},7664:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return i},metadata:function(){return o},toc:function(){return p},default:function(){return c}});var n=a(2122),r=a(9756),l=(a(7294),a(3905)),i={id:"local-deployment",title:"Local Deployment"},o={unversionedId:"getting-started/local-deployment",id:"version-0.9.0/getting-started/local-deployment",isDocsHomePage:!1,title:"Local Deployment",description:"This page will walk you through:",source:"@site/versioned_docs/version-0.9.0/getting-started/local-deployment.mdx",sourceDirName:"getting-started",slug:"/getting-started/local-deployment",permalink:"/docs/getting-started/local-deployment",version:"0.9.0",frontMatter:{id:"local-deployment",title:"Local Deployment"},sidebar:"version-0.9.0/docs",previous:{title:"What is Drill4J",permalink:"/docs/what-is-drill4j"},next:{title:"API Tests",permalink:"/docs/tests-integration/api-tests"}},p=[{value:"Prerequisites",id:"prerequisites",children:[]},{value:"Deploy Core Drill4J Services",id:"deploy-core-drill4j-services",children:[]},{value:"Check Services Availability",id:"check-services-availability",children:[{value:"Troubleshooting",id:"troubleshooting",children:[]}]},{value:"Generate API Key",id:"generate-api-key",children:[]},{value:"Setup Java Agent",id:"setup-java-agent",children:[]},{value:"Inspect Metrics",id:"inspect-metrics",children:[]},{value:"Next Steps and Further Reading",id:"next-steps-and-further-reading",children:[]}],s={toc:p};function c(e){var t=e.components,i=(0,r.Z)(e,["components"]);return(0,l.kt)("wrapper",(0,n.Z)({},s,i,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"This page will walk you through:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Running core Drill4J Services"),(0,l.kt)("li",{parentName:"ol"},"Drill4J Agent configuration steps to collect metrics for your Java application.")),(0,l.kt)("p",null,"It assumes you're running all services on your local machine."),(0,l.kt)("p",null,"It's a good starting point to get familiar with Drill4J. For installation and configuration in your actual development and testing environments, refer to the additional documentation (links at the bottom of the page)."),(0,l.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("a",{parentName:"li",href:"https://www.docker.com/"},"Docker")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("a",{parentName:"li",href:"https://docs.docker.com/compose/"},"Docker Compose")),(0,l.kt)("li",{parentName:"ol"},"The current release supports ",(0,l.kt)("inlineCode",{parentName:"li"},"x64")," but not ",(0,l.kt)("inlineCode",{parentName:"li"},"arm"),"-based machines. Specifically, it won\u2019t work on Apple Silicon CPUs (M-series). Support for ARM-based machines is being worked on.")),(0,l.kt)("h2",{id:"deploy-core-drill4j-services"},"Deploy Core Drill4J Services"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Download the following files and put them in the empty folder:"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{target:"_blank",href:a(1286).Z},"docker-compose.yml")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{target:"_blank",href:a(7020).Z},".env")))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Create ",(0,l.kt)("inlineCode",{parentName:"p"},"db-init")," folder next to ",(0,l.kt)("inlineCode",{parentName:"p"},"docker-compose.yml"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Download ",(0,l.kt)("inlineCode",{parentName:"p"},"data.sql")," from ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/Drill4J/drill-metabase-dashboards/releases/tag/v18"},"https://github.com/Drill4J/drill-metabase-dashboards/releases/tag/v18")," and place in ",(0,l.kt)("inlineCode",{parentName:"p"},"db-init")," folder")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Your folder structure should match the following:"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"- docker-compose.yml\n- .env\n- db-init/data.sql\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Open terminal in this folder and execute:"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"  docker-compose up -d\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Wait for docker-compose to download images and launch containers."))),(0,l.kt)("h2",{id:"check-services-availability"},"Check Services Availability"),(0,l.kt)("p",null,"To make sure everything is working:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"http://localhost:8090/"},"Drill4J Admin Backend")," must return "),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-json"},'  {\n    "message": "Drill4J Admin Backend"\n  }\n'))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"http://localhost:8091"},"Drill4J UI")," must display  authentication form."),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Default credentials: user: ",(0,l.kt)("inlineCode",{parentName:"li"},"admin")," password: ",(0,l.kt)("inlineCode",{parentName:"li"},"admin"),"."))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"http://localhost:8095"},"Metabase")," must display Metabase UI authentication form."),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Default credentials: user: ",(0,l.kt)("inlineCode",{parentName:"li"},"user@user.user")," password: ",(0,l.kt)("inlineCode",{parentName:"li"},"useruser1")),(0,l.kt)("li",{parentName:"ul"},"After you login to Metabase UI you should see ",(0,l.kt)("inlineCode",{parentName:"li"},'"Builds"')," dashboard being available in Bookmarks section")))),(0,l.kt)("h3",{id:"troubleshooting"},"Troubleshooting"),(0,l.kt)("p",null,"Skip this section if you experience no problems"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"I don't see the Metabase authentication form and instead presented with this message:"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},'"Welcome to Metabase - Looks like everything is working. Now let\u2019s get to know you, connect to your data, and start finding you some answers!\n')),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Reason: Metabase was not propertly initalized. You likely have either skipped downloading ",(0,l.kt)("inlineCode",{parentName:"li"},"data.sql")," file or misplaced it. Make sure to put it in ",(0,l.kt)("inlineCode",{parentName:"li"},"db-init")," folder next to the ",(0,l.kt)("inlineCode",{parentName:"li"},"docker-compose.yml")," file. ")))),(0,l.kt)("h2",{id:"generate-api-key"},"Generate API Key"),(0,l.kt)("p",null,"Drill4J Backend authenticates incoming data using API keys. To generate new API key:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Open Drill4J UI ",(0,l.kt)("a",{parentName:"li",href:"http://localhost:8091/my-api-keys"},"My API Keys")," section "),(0,l.kt)("li",{parentName:"ol"},'At the top of the page, enter description for the new key and click "Generate" button.'),(0,l.kt)("li",{parentName:"ol"},"New API key row must appear in the table."),(0,l.kt)("li",{parentName:"ol"},"The actual key value is copied to your clipboard. Paste it somewhere safe for the next step.")),(0,l.kt)("h2",{id:"setup-java-agent"},"Setup Java Agent"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Download the Drill4J Java Agent ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/Drill4J/java-agent/releases/tag/v0.9.0"},"https://github.com/Drill4J/java-agent/releases/tag/v0.9.0")," release zip file. Pick the release appropriate for your platform (",(0,l.kt)("inlineCode",{parentName:"p"},"mingwx64")," - Windows; Mac and Linux are called correspondingly)")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Unzip the file. Change the release-specific folder name  (e..g ",(0,l.kt)("inlineCode",{parentName:"p"},"linuxX64-0.9.0-beta.5"),") to simply ",(0,l.kt)("inlineCode",{parentName:"p"},"agent"),". The folder must contain:"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"- drill.properties\n- drill-runtime.jar\n- libdrill_agent.dll # .so for Linux; .dylib for Mac\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Place this ",(0,l.kt)("inlineCode",{parentName:"p"},"agent")," folder next to ",(0,l.kt)("strong",{parentName:"p"},"your Java application")," ",(0,l.kt)("inlineCode",{parentName:"p"},".jar")," file")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Open ",(0,l.kt)("inlineCode",{parentName:"p"},"drill.properties")," file and set the following properties:"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},'  drillApiUrl=http://localhost:8090/api\n\n  # Paste the API key value here\n  # Putting key in .properties file is _not_ the recommended way to handle API keys. See Java Agent documentation section for more info\n  drillApiKey= \n\n  # These properties identify your application in Drill4J.\n  # For now set to the following:\n  groupId=my-app\n  appId=backend\n  buildVersion=1.0.0\n\n  # IMPORTANT: make sure to set to actual name of your application\'s _topmost_ package\n  # replace "." with "/"\n  # Example: my.org.something.app -> my/org/something/app\n  packagePrefixes=\n\n'))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Launch your application:"),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Considering your application is launched with"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"  java -jar my-app.jar\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Change it to be"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Windows")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"  java -agentpath:/agent/libdrill_agent.dll -jar my-app.jar\n")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Linux")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"  java -agentpath:/agent/libdrill_agent.so -jar my-app.jar\n")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"For Mac")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"  java -agentpath:/agent/libdrill_agent.dylib -jar my-app.jar\n"))))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"To confirm Drill4J Java Agent is running check your application log. There must be Drill4J ASCII art followed with agent version and log entry:"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-log"},'  ____    ____                 _       _          _  _                _      \n |  _"\\U |  _"\\ u     ___     |"|     |"|        | ||"|            U |"| u   \n/| | | |\\| |_) |/    |_"_|  U | | u U | | u      | || |_          _ \\| |/    \nU| |_| |\\|  _ <       | |    \\| |/__ \\| |/__     |__   _|        | |_| |_,-. \n |____/ u|_| \\_\\    U/| |\\u   |_____| |_____|      /|_|\\          \\___/-(_/  \n  |||_   //   \\\\_.-,_|___|_,-.//  \\\\  //  \\\\      u_|||_u          _//       \n(__)_) (__)  (__)\\_)-\' \'-(_/(_")("_)(_")("_)     (__)__)         (__)  \nJava Agent (v0.9.0)\n[com.epam.drill.agent.Agent] agentOnLoad: Java Agent has been loaded.\n')))),(0,l.kt)("h2",{id:"inspect-metrics"},"Inspect Metrics"),(0,l.kt)("p",null,"In Metabase UI navigate to ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8095/dashboard/1-builds?group=&app="},"Builds Dashboard")),(0,l.kt)("p",null,"You should see Builds table containing a single entry, corresponding to your application."),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Click on the value of first column ",(0,l.kt)("inlineCode",{parentName:"p"},"my-app:backend:1.0.0")," and you should be taken to ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8095/dashboard/2?group=my-app&app=backend&build=my-app%3Abackend%3A1.0.0&baseline_build=&package_filter=*&class_filter=*"},"Build - Summary")," dashboard")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Scroll down to see application ",(0,l.kt)("em",{parentName:"p"},"Coverage")," metrics"),(0,l.kt)("blockquote",{parentName:"li"},(0,l.kt)("p",{parentName:"blockquote"},'Some components will display "There was a problem displaying this chart". This is not an error and is expected.'),(0,l.kt)("p",{parentName:"blockquote"},"This is due to the fact you have to complete additional configuration in order to see complete metrics."))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Click on piecharts to navigate to detailed coverage dashboards  "))),(0,l.kt)("p",null,"Try interacting with your application (execute some tests, call API endpoints) and then check back to Metabase UI to see how your application coverage % changes."),(0,l.kt)("h2",{id:"next-steps-and-further-reading"},"Next Steps and Further Reading"),(0,l.kt)("p",null,"This guide covered the basics of deploying Drill4J Services and the Application Agent, which gives you basic ",(0,l.kt)("em",{parentName:"p"},"Coverage")," metrics."),(0,l.kt)("p",null,"For more advanced metrics, integrate Drill4J with your tests. For more details, check out the additional documentation:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("a",{parentName:"li",href:"/docs/tests-integration/api-tests"},"API tests integration"))))}c.isMDXComponent=!0},1286:function(e,t,a){"use strict";t.Z=a.p+"assets/files/docker-compose-487188ee941d14d81ba3536c9069f562.yml"},7020:function(e,t,a){"use strict";t.Z=a.p+"assets/files/drill-f99f305bba555b7e7b4b60ab2ea90dfc.env"}}]);