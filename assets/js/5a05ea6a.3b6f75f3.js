(self.webpackChunkdrill4j_github_io=self.webpackChunkdrill4j_github_io||[]).push([[3923],{3905:function(e,t,a){"use strict";a.d(t,{Zo:function(){return d},kt:function(){return u}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),c=s(a),u=r,g=c["".concat(p,".").concat(u)]||c[u]||m[u]||i;return a?n.createElement(g,l(l({ref:t},d),{},{components:a})):n.createElement(g,l({ref:t},d))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=c;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var s=2;s<i;s++)l[s]=a[s];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},8648:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return l},metadata:function(){return o},toc:function(){return p},default:function(){return d}});var n=a(2122),r=a(9756),i=(a(7294),a(3905)),l={id:"java-agent",title:"Application Agent"},o={unversionedId:"agents/java-agent",id:"version-0.9.0/agents/java-agent",isDocsHomePage:!1,title:"Application Agent",description:"Drill4J Java Agent enables metrics collection for JVM-based applications.",source:"@site/versioned_docs/version-0.9.0/agents/application-agent.mdx",sourceDirName:"agents",slug:"/agents/java-agent",permalink:"/docs/agents/java-agent",version:"0.9.0",frontMatter:{id:"java-agent",title:"Application Agent"},sidebar:"version-0.9.0/docs",previous:{title:"Gitlab Integration",permalink:"/docs/cicd-integration/gitlab"},next:{title:"CI/CD Integration Plugin",permalink:"/docs/cicd-integration/cicd-integration-plugin"}},p=[{value:"How to download",id:"how-to-download",children:[{value:"Download agent files manually",id:"download-agent-files-manually",children:[]},{value:"Use Docker image with a download script",id:"use-docker-image-with-a-download-script",children:[]},{value:"Use Drill4J CI/CD Integration Plugin for Maven and Gradle",id:"use-drill4j-cicd-integration-plugin-for-maven-and-gradle",children:[]}]},{value:"How to set path to agent",id:"how-to-set-path-to-agent",children:[{value:"Pass <code>-agentpath:</code> directly to Java process",id:"pass--agentpath-directly-to-java-process",children:[]},{value:"Set <code>-agentpath</code> to <code>JAVA_TOOL_OPTIONS</code> env variable",id:"set--agentpath-to-java_tool_options-env-variable",children:[]},{value:"Troubleshooting",id:"troubleshooting",children:[]}]},{value:"How to set agent parameters",id:"how-to-set-agent-parameters",children:[{value:"Set parameters using environment variables",id:"set-parameters-using-environment-variables",children:[]},{value:"Set parameters in <code>-agentpath</code> argument string",id:"set-parameters-in--agentpath-argument-string",children:[]},{value:"Set parameters in <code>drill.properties</code> file",id:"set-parameters-in-drillproperties-file",children:[]}]},{value:"Agent parameters reference",id:"agent-parameters-reference",children:[{value:"Env variables naming",id:"env-variables-naming",children:[]},{value:"How to set package prefixes",id:"how-to-set-package-prefixes",children:[]},{value:"API key security",id:"api-key-security",children:[]},{value:"Considerations regarding <code>buildVersion</code> and <code>commitSha</code>",id:"considerations-regarding-buildversion-and-commitsha",children:[]}]},{value:"Troubleshooting",id:"troubleshooting-1",children:[{value:"How to confirm agent is loaded",id:"how-to-confirm-agent-is-loaded",children:[]},{value:"Cannot load the agent because some agent parameters are set incorrectly",id:"cannot-load-the-agent-because-some-agent-parameters-are-set-incorrectly",children:[]}]},{value:"Limitations and Known Issues",id:"limitations-and-known-issues",children:[]}],s={toc:p};function d(e){var t=e.components,l=(0,r.Z)(e,["components"]);return(0,i.kt)("wrapper",(0,n.Z)({},s,l,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Drill4J Java Agent enables metrics collection for JVM-based applications."),(0,i.kt)("p",null,"General integration steps are:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"#how-to-download"},"Download Drill4J agent files")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"#how-to-set-path-to-agent"},"Set path to agent")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"#how-to-set-agent-parameters"},"Set agent parameters"))),(0,i.kt)("p",null,"Due to the diverse tools used in software development \u2014 such as CI/CD providers, deployment methods, testing stages \u2014 the exact process will depend on the environment."),(0,i.kt)("h2",{id:"how-to-download"},"How to download"),(0,i.kt)("h3",{id:"download-agent-files-manually"},"Download agent files manually"),(0,i.kt)("p",null,"The most basic way to get agent files is to download release .zip manually."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Download release appropriate for your platform at  ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/Drill4J/java-agent/releases/tag/v0.9.1"},"https://github.com/Drill4J/java-agent/releases/tag/v0.9.1"),"."),(0,i.kt)("blockquote",{parentName:"li"},(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("inlineCode",{parentName:"p"},"mingwX64")," is for Windows, Linux and Mac releases are called respectively."))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Unzip the file. Rename unzipped folder to ",(0,i.kt)("inlineCode",{parentName:"p"},"agent"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Inside you'll find the following files:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"libdrill_agent.so")," (on Windows - ",(0,i.kt)("inlineCode",{parentName:"li"},".dll"),", on Mac - ",(0,i.kt)("inlineCode",{parentName:"li"},".dylib"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"drill-runtime.jar")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"drill.properties"))))),(0,i.kt)("p",null,"Refer to ",(0,i.kt)("a",{parentName:"p",href:"/docs/agents/java-agent#how-to-set-path-to-agent"},"next section")," for further steps."),(0,i.kt)("h3",{id:"use-docker-image-with-a-download-script"},"Use Docker image with a download script"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Use case"),": when you are already using Docker Compose to start your application.")),(0,i.kt)("p",null,"We provide a small Docker image, that executes download script upon startup."),(0,i.kt)("p",null,"The way it works is:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"You add our container to your docker-compose.yml file, passing the desired version to ",(0,i.kt)("inlineCode",{parentName:"li"},"JAVA_AGENT")," env variable."),(0,i.kt)("li",{parentName:"ol"},"On startup, the container launches the download script."),(0,i.kt)("li",{parentName:"ol"},"Docker's healthcheck waits for it to complete."),(0,i.kt)("li",{parentName:"ol"},"Downloaded agent files are placed in a shared volume."),(0,i.kt)("li",{parentName:"ol"},"Shared volume is mounted to your application's container.")),(0,i.kt)("p",null,"See the example ",(0,i.kt)("a",{target:"_blank",href:a(270).Z},"docker-compose.yml")," file for details."),(0,i.kt)("h3",{id:"use-drill4j-cicd-integration-plugin-for-maven-and-gradle"},"Use Drill4J CI/CD Integration Plugin for Maven and Gradle"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Use cases"),": when application (or certain classes of application) is launched with Maven or Gradle. Thats most often the case with ",(0,i.kt)("strong",{parentName:"p"},"Unit tests"),".")),(0,i.kt)("p",null,"Drill4J CI/CD Integration Plugin ",(0,i.kt)("strong",{parentName:"p"},"automatically downloads agent files")," and ",(0,i.kt)("strong",{parentName:"p"},"passes required parameters to Java"),"."),(0,i.kt)("p",null,"Because of that, the next sections of this page are irrelevant in this scenario. Instead, please refer to ",(0,i.kt)("a",{parentName:"p",href:"/docs/cicd-integration/cicd-integration-plugin"},"CI/CD Integration Plugin")," page for more info."),(0,i.kt)("h2",{id:"how-to-set-path-to-agent"},"How to set path to agent"),(0,i.kt)("p",null,"Java allows to load agents using ",(0,i.kt)("a",{parentName:"p",href:"https://docs.oracle.com/javase/8/docs/platform/jvmti/jvmti.html#starting"},"special command line argument"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"java -agentpath:<path-to-agent>\n")),(0,i.kt)("p",null,"Where ",(0,i.kt)("inlineCode",{parentName:"p"},"<path-to-agent>")," must point to agent library file."),(0,i.kt)("p",null,"There are two way to set this command line argument."),(0,i.kt)("h3",{id:"pass--agentpath-directly-to-java-process"},"Pass ",(0,i.kt)("inlineCode",{parentName:"h3"},"-agentpath:")," directly to Java process"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Use case"),": when you have a direct access to ",(0,i.kt)("strong",{parentName:"p"},"Java"),"'s process launch arguments. ")),(0,i.kt)("p",null,"Considering your application is launched with:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"  java -jar my-app.jar\n")),(0,i.kt)("p",null,"Change it to:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"  # Linux \n  java -agentpath:/agent/libdrill_agent.so -jar my-app.jar\n  # Windows\n  java -agentpath:/agent/drill_agent.dll -jar my-app.jar\n  # macOS \n  java -agentpath:/agent/libdrill_agent.dylib -jar my-app.jar\n")),(0,i.kt)("h3",{id:"set--agentpath-to-java_tool_options-env-variable"},"Set ",(0,i.kt)("inlineCode",{parentName:"h3"},"-agentpath")," to ",(0,i.kt)("inlineCode",{parentName:"h3"},"JAVA_TOOL_OPTIONS")," env variable"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Use case"),": when you don't have direct access to the ",(0,i.kt)("strong",{parentName:"p"},"Java"),"'s process launch arguments. It's often the case when app is launched somewhere deep in scripts or inside Docker container.")),(0,i.kt)("p",null,"Use ",(0,i.kt)("a",{parentName:"p",href:"https://docs.oracle.com/javase/8/docs/platform/jvmti/jvmti.html#tooloptions"},(0,i.kt)("inlineCode",{parentName:"a"},"JAVA_TOOL_OPTIONS"))," to instruct ",(0,i.kt)("strong",{parentName:"p"},"Java")," to use Drill4J Java Agent. Its a built-in env variable supported by any Java version."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"  JAVA_TOOL_OPTIONS=-agentpath:/agent/libdrill_agent.so\n  # Linux - libdrill_agent.so\n  # Windows - drill_agent.dll\n  # macOS - libdrill_agent.dylib\n")),(0,i.kt)("h3",{id:"troubleshooting"},"Troubleshooting"),(0,i.kt)("p",null,"To ensure you set agentpath correctly see ",(0,i.kt)("a",{parentName:"p",href:"#how-to-confirm-agent-is-loaded"},"how to confirm agent is loaded")," section below."),(0,i.kt)("h2",{id:"how-to-set-agent-parameters"},"How to set agent parameters"),(0,i.kt)("p",null,"Drill4J agent supports 3 ways to set agent ",(0,i.kt)("a",{parentName:"p",href:"#agent-parameters-reference"},"parameters")),(0,i.kt)("h3",{id:"set-parameters-using-environment-variables"},"Set parameters using environment variables"),(0,i.kt)("p",null,"This is the recommended way to set agent parameters."),(0,i.kt)("p",null,"Env variables names are prefixed with ",(0,i.kt)("inlineCode",{parentName:"p"},"DRILL_")," with uppercase snake case. Examples:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Given ",(0,i.kt)("inlineCode",{parentName:"li"},"packagePrefixes")," parameter the env variable is ",(0,i.kt)("inlineCode",{parentName:"li"},"DRILL_PACKAGE_PREFIXES"))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Precedence"),": parameter values set with env variables have the highest precedence and will override values set in ",(0,i.kt)("inlineCode",{parentName:"p"},"-agentpath")," string or  ",(0,i.kt)("inlineCode",{parentName:"p"},"drill.properties")," file."),(0,i.kt)("h3",{id:"set-parameters-in--agentpath-argument-string"},"Set parameters in ",(0,i.kt)("inlineCode",{parentName:"h3"},"-agentpath")," argument string"),(0,i.kt)("p",null,"Append parameters to the ",(0,i.kt)("inlineCode",{parentName:"p"},"-agentpath")," argument string. Add ",(0,i.kt)("inlineCode",{parentName:"p"},"=<options>")," after ",(0,i.kt)("inlineCode",{parentName:"p"},"<path-to-agent>"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"-agentpath:<path-to-agent>=<options>\n")),(0,i.kt)("p",null,"Example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"-agentpath:/agent/libdrill_agent.so=parameter1=hello,parameter2=bar\n")),(0,i.kt)("p",null,"Parameters are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"passed after ",(0,i.kt)("inlineCode",{parentName:"li"},"<path-to-agent>")," (",(0,i.kt)("inlineCode",{parentName:"li"},"/agent/libdrill_agent.so")," above)"),(0,i.kt)("li",{parentName:"ul"},"start of parameters string is indicated with ",(0,i.kt)("inlineCode",{parentName:"li"},"=")," sign"),(0,i.kt)("li",{parentName:"ul"},"parameters are ",(0,i.kt)("inlineCode",{parentName:"li"},"<key>=<value>")," pairs"),(0,i.kt)("li",{parentName:"ul"},"each pair is separated by comma.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Precedence"),": parameter values set with ",(0,i.kt)("inlineCode",{parentName:"p"},"-agentpath")," will override values set in ",(0,i.kt)("inlineCode",{parentName:"p"},"drill.properties")),(0,i.kt)("h3",{id:"set-parameters-in-drillproperties-file"},"Set parameters in ",(0,i.kt)("inlineCode",{parentName:"h3"},"drill.properties")," file"),(0,i.kt)("p",null,"Alternatively, Drill4J agent checks for values in ",(0,i.kt)("inlineCode",{parentName:"p"},"drill.properties")," file. By default it is downloaded with agent files."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"parameter1=hello\nparameter2=bar\n")),(0,i.kt)("p",null,"It adheres to the ",(0,i.kt)("a",{parentName:"p",href:"https://docs.oracle.com/cd/E23095_01/Platform.93/ATGProgGuide/html/s0204propertiesfileformat01.html"},"properties file syntax")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Precedence"),": parameter values set in ",(0,i.kt)("inlineCode",{parentName:"p"},"drill.properties")," file have the lowest precedence and can be overriden by ",(0,i.kt)("inlineCode",{parentName:"p"},"-agentpath")," and env variables."),(0,i.kt)("h2",{id:"agent-parameters-reference"},"Agent parameters reference"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,i.kt)("th",{parentName:"tr",align:null},"Required"),(0,i.kt)("th",{parentName:"tr",align:null},"Example Value"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"apiUrl"),(0,i.kt)("td",{parentName:"tr",align:null},"yes"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"http://localhost/api")),(0,i.kt)("td",{parentName:"tr",align:null},"URL to Drill4J Admin /api endpoint.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"apiKey"),(0,i.kt)("td",{parentName:"tr",align:null},"yes"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"1_01cdf51ff20544ee...")),(0,i.kt)("td",{parentName:"tr",align:null},"Drill4J Backend API key. Generate it using Drill4J UI.  Please make sure to read the ",(0,i.kt)("a",{parentName:"td",href:"#api-key-security"},"apiKey security")," section")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"groupId"),(0,i.kt)("td",{parentName:"tr",align:null},"yes"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"my-cool-app")),(0,i.kt)("td",{parentName:"tr",align:null},"Unique arbitrary string identifying your application group.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"appId"),(0,i.kt)("td",{parentName:"tr",align:null},"yes"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"api-service")),(0,i.kt)("td",{parentName:"tr",align:null},"Unique arbitrary string identifying your application.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"packagePrefixes"),(0,i.kt)("td",{parentName:"tr",align:null},"yes"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"my/org/somecoolapp")),(0,i.kt)("td",{parentName:"tr",align:null},"Specifies the packages for Drill4J to monitor. See ",(0,i.kt)("a",{parentName:"td",href:"#how-to-set-package-prefixes"},"syntax and examples")," below.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"buildVersion"),(0,i.kt)("td",{parentName:"tr",align:null},"recommended ",(0,i.kt)("br",null)," ",(0,i.kt)("a",{parentName:"td",href:"#considerations-regarding-buildversion-and-commitsha"},"see more")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"v1.2.3")),(0,i.kt)("td",{parentName:"tr",align:null},"Build version of your application. Typically set to version tag.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"commitSha"),(0,i.kt)("td",{parentName:"tr",align:null},"recommended ",(0,i.kt)("br",null)," ",(0,i.kt)("a",{parentName:"td",href:"#considerations-regarding-buildversion-and-commitsha"},"see more")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"8d87b0c2379a925...")),(0,i.kt)("td",{parentName:"tr",align:null},"Full SHA hash of commit from which your application .jar is built from.")))),(0,i.kt)("h3",{id:"env-variables-naming"},"Env variables naming"),(0,i.kt)("p",null,"Environment variables start with the prefix ",(0,i.kt)("inlineCode",{parentName:"p"},"DRILL_"),", followed by the parameter name in ",(0,i.kt)("inlineCode",{parentName:"p"},"UPPERCASE_SNAKE_CASE"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Example"),":"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"For ",(0,i.kt)("inlineCode",{parentName:"li"},"apiUrl"),", the env var is ",(0,i.kt)("inlineCode",{parentName:"li"},"DRILL_API_URL"),"."),(0,i.kt)("li",{parentName:"ol"},"For ",(0,i.kt)("inlineCode",{parentName:"li"},"packagePrefixes"),", the env var is ",(0,i.kt)("inlineCode",{parentName:"li"},"DRILL_PACKAGE_PREFIXES"),".")),(0,i.kt)("h3",{id:"how-to-set-package-prefixes"},"How to set package prefixes"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"packagePrefixes")," is the filter that specifies which packages Drill4J should monitor. It is usually set to the topmost common package of your application."),(0,i.kt)("p",null,"Avoid setting it to something very broad (like ",(0,i.kt)("inlineCode",{parentName:"p"},"com")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"org"),") - otherwise you will be scanning and collecting metrics for third-party dependencies."),(0,i.kt)("h4",{id:"syntax"},"Syntax"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Parts of package names are separated with forward slashes ",(0,i.kt)("inlineCode",{parentName:"li"},"/")," (and not dots ",(0,i.kt)("inlineCode",{parentName:"li"},"."),")"),(0,i.kt)("li",{parentName:"ol"},"Multiple packages can be specified using ",(0,i.kt)("inlineCode",{parentName:"li"},";")," delimiter"),(0,i.kt)("li",{parentName:"ol"},"To exclude package use ",(0,i.kt)("inlineCode",{parentName:"li"},"!")," prefix.")),(0,i.kt)("h4",{id:"example"},"Example"),(0,i.kt)("p",null,"Given you app packages are:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"my.org.somecoolapp.user")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"my.org.somecoolapp.orders.repository")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"my.org.somecoolapp.db.models"))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"packagePrefixes")," parameter should be set to ",(0,i.kt)("inlineCode",{parentName:"p"},"my/org/somecoolapp")),(0,i.kt)("h4",{id:"adding-extra-package"},"Adding extra package"),(0,i.kt)("p",null,"Add package name separated by ",(0,i.kt)("inlineCode",{parentName:"p"},";")," - ",(0,i.kt)("inlineCode",{parentName:"p"},"my/org/somecoolapp;some/other/package"),"."),(0,i.kt)("p",null,"This adds both ",(0,i.kt)("inlineCode",{parentName:"p"},"my/org/somecoolapp")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"some.other.package")," to scanned packages."),(0,i.kt)("h4",{id:"excluding-package"},"Excluding package"),(0,i.kt)("p",null,"Add package name prefixed with ",(0,i.kt)("inlineCode",{parentName:"p"},"!")," - ",(0,i.kt)("inlineCode",{parentName:"p"},"my/org/somecoolapp;!my.org.somecoolapp.db.models"),"."),(0,i.kt)("p",null,"This adds ",(0,i.kt)("inlineCode",{parentName:"p"},"my/org/somecoolapp")," to scanned packages, but excludes ",(0,i.kt)("inlineCode",{parentName:"p"},"my.org.somecoolapp.db.models"),"."),(0,i.kt)("h3",{id:"api-key-security"},"API key security"),(0,i.kt)("p",null,"\u2757 Please avoid hardcoding ",(0,i.kt)("strong",{parentName:"p"},"apiKey")," and exposing it in plain text. Instead, use environment variables. \u2757"),(0,i.kt)("p",null,"Bad example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"  -agentpath:/agent/libdrill_agent.so=drillApiKey=123\n")),(0,i.kt)("p",null,"Good example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"  # Set DRILL_API_KEY variable prior to application launch\n  DRILL_API_KEY=123\n  # exact syntax for env variables will depend on your environment\n")),(0,i.kt)("h3",{id:"considerations-regarding-buildversion-and-commitsha"},"Considerations regarding ",(0,i.kt)("inlineCode",{parentName:"h3"},"buildVersion")," and ",(0,i.kt)("inlineCode",{parentName:"h3"},"commitSha")),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Necessity"),": While ",(0,i.kt)("inlineCode",{parentName:"p"},"buildVersion")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"commitSha")," are not strictly required, we recommend providing at least one (ideally both) for the following reasons:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"It allows Drill4J to group metrics by version or commit."),(0,i.kt)("li",{parentName:"ul"},"Without ",(0,i.kt)("inlineCode",{parentName:"li"},"buildVersion")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"commitSha"),", Drill4J reports each application instance individually. Instances are identified with a random UUID."))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Uniqueness"),": Both ",(0,i.kt)("inlineCode",{parentName:"p"},"buildVersion")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"commitSha")," identify a unique application version, each associated with a specific set of classes and methods."),(0,i.kt)("p",{parentName:"li"},"To maintain the integrity of metrics, ensure that different application versions do not share the same ",(0,i.kt)("inlineCode",{parentName:"p"},"buildVersion")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"commitSha")," values."),(0,i.kt)("p",{parentName:"li"},"Using identical values across different versions will lead to inaccurate metrics due to the mixing of unrelated data.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Semantics"),": ",(0,i.kt)("inlineCode",{parentName:"p"},"buildVersion")," typically corresponds to the version tag of your application. "),(0,i.kt)("p",{parentName:"li"},"Compliance with ",(0,i.kt)("a",{parentName:"p",href:"https://semver.org/"},"Semver")," is not required. Drill4J treats the build version as a unique string for grouping metrics, without any added semantics."))),(0,i.kt)("h2",{id:"troubleshooting-1"},"Troubleshooting"),(0,i.kt)("h3",{id:"how-to-confirm-agent-is-loaded"},"How to confirm agent is loaded"),(0,i.kt)("p",null,"Once loaded Drill4J agent prints the following ASCII logo:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-log"},'  ____    ____                 _       _          _  _                _      \n  |  _"\\U |  _"\\ u     ___     |"|     |"|        | ||"|            U |"| u   \n/| | | |\\| |_) |/    |_"_|  U | | u U | | u      | || |_          _ \\| |/    \nU| |_| |\\|  _ <       | |    \\| |/__ \\| |/__     |__   _|        | |_| |_,-. \n  |____/ u|_| \\_\\    U/| |\\u   |_____| |_____|      /|_|\\          \\___/-(_/  \n  |||_   //   \\\\_.-,_|___|_,-.//  \\\\  //  \\\\      u_|||_u          _//       \n(__)_) (__)  (__)\\_)-\' \'-(_/(_")("_)(_")("_)     (__)__)         (__)  \nJava Agent (v0.9.1)\n')),(0,i.kt)("p",null,"It indicates that you have configured agent path correctly and Java picked up and loaded agent files."),(0,i.kt)("h3",{id:"cannot-load-the-agent-because-some-agent-parameters-are-set-incorrectly"},"Cannot load the agent because some agent parameters are set incorrectly"),(0,i.kt)("p",null,"If below Drill4J ASCII logo you see the following message:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"ERROR [com.epam.drill.agent.configuration.ValidatedParametersProvider] Cannot load the agent because some agent parameters are set incorrectly. Please \ncheck the following parameters:\n")),(0,i.kt)("p",null,"It indicates that you are missing some required parameters. Refer to the ",(0,i.kt)("a",{parentName:"p",href:"#agent-parameters-configuration-options"},"agent parameters")," section."),(0,i.kt)("h2",{id:"limitations-and-known-issues"},"Limitations and Known Issues"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"While ",(0,i.kt)("strong",{parentName:"li"},"x64")," Macs are supported, ",(0,i.kt)("strong",{parentName:"li"},"ARM")," Macs (M-series Apple Silicon CPUs) are not yet supported; work is in progress.")))}d.isMDXComponent=!0},270:function(e,t,a){"use strict";t.Z=a.p+"assets/files/download-agent-files.docker-compose-9d39693c72aa3cdee1bcb65563cae014.yml"}}]);